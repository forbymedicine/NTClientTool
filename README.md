# NTClientTool

Утилита для автоматизации работы с ЭЦП в программе **NTClientSoftware** (Avest). Проект предназначен для упрощения рутинных операций при работе с электронной цифровой подписью.

## Возможности

-  **Автоматическое закрытие лишних окон** – при запуске NTClientSoftware.exe утилита закрывает два ненужных диалоговых окна:
  - "Клиентская программа успешна запущена"
  - "Программа продолжит работу в фоновом режиме..."
  
-  **Вывод окна выбора сертификатов на передний план** – диалоговое окно выбора сертификатов автоматически становится поверх всех окон (TOPMOST)

-  **Автоматический ввод пароля** – утилита считывает пароль для контейнера из файла конфигурации и автоматически:
  - Определяет поле ввода пароля
  - Вставляет сохраненный пароль
  - Нажимает кнопку "OK"

## Как это работает

1. Программа ожидает запуск процесса `NTClientSoftware.exe`
2. При обнаружении процесса устанавливает хуки на события окон
3. Отслеживает появление окон, связанных с ЭЦП
4. Вводит пароль в окно с ЭЦП

## Формат файла конфигурации

Пароли хранятся в файле `%APPDATA%\Avest\saved.txt` в формате:

```имя_контейнера:пароль```

Например:

```AvPass S/N AVP6000123456:123456781```

В файл конфигурации можно установить ```skip_cert_window:true```
В этом случае утилита будет нажимать "ОК" в окне выбора сертификата, если на текущем пользователе установлен только один сертификат.⚠️ *Работает нестабильно* 

## Системные требования

- **ОС:** Windows 10/11
- **Права администратора:** не требуются

## Автозагрузка

Рекомендуется добавить программу в автозагрузку:

1. Откройте редактор реестра (`regedit.exe`)
2. Перейдите в раздел:
```HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run```
3. Создайте строковый параметр (REG_SZ):
- **Имя:** `NTClientTool`
- **Значение:** `путь_до_NTClientTool.exe`

❤️ Сделано с любовью для медиков, которые нас лечат!
